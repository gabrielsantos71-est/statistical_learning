<!DOCTYPE html>
<html lang="pt-BR"><head>
<script src="aula9_files/libs/clipboard/clipboard.min.js"></script>
<script src="aula9_files/libs/quarto-html/tabby.min.js"></script>
<script src="aula9_files/libs/quarto-html/popper.min.js"></script>
<script src="aula9_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="aula9_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="aula9_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="aula9_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="LECON/DEST - UFES">
  <title>STA13824 - Análise de regressão  Análise residual </title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="aula9_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="aula9_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="aula9_files/libs/revealjs/dist/theme/quarto-bbd3fe9ba78fe19100bb54757e835c1d.css">
  <link href="aula9_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="aula9_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="aula9_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="aula9_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="aula9_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="aula9_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#172a46" data-background-opacity="number" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">STA13824 - Análise de regressão<br>
</h1><h3><br>
Análise residual<br>
</h3>
  <p class="subtitle"><br><br></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
LECON/DEST - UFES 
</div>
        <p class="quarto-title-affiliation">
            Última atualização: 03 julho, 2025
          </p>
    </div>
</div>

</section>
<section class="slide level2">

<h3 id="análise-residual">Análise residual</h3>
<p>Considere o modelo é linear, dado por</p>
<p><span class="math display">\[Y=\mathbf{X\,\beta}+\mathbf{\epsilon}.\]</span> O vetor de erros <span class="math inline">\(\epsilon\)</span> é uma variável aleatória <strong>não-observável</strong>.</p>
<p><br></p>
<p>A diferença do vetor de erros, o vetor de resíduos é uma variável observável e será importante para avaliar a proximidade entre os valores ajustados do modelo e os valores observados. Por definição, o vetor de resíduos é dado por</p>
<p><span class="math display">\[e=Y-\hat{Y}=(I-H)Y,\]</span> onde <span class="math inline">\(H=\mathbf{X}\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\)</span>.</p>
</section>
<section class="slide level2">

<p>Os resíduos podem ser usados para aproximar o vetor de erros no modelo de regressão, e a distribuição empírica dos resíduos pode ser utilizada para verificar:</p>
<ul>
<li>A suposição de normalidade (Suposição <strong>A5</strong>);</li>
<li>A suposição de exogeneidade e esfericidade dos erros (Suposições <strong>A3</strong> e <strong>A4</strong>);</li>
<li>O sobreajuste do modelo (<em>overfitting</em>), subajuste do modelo (<em>underfitting</em>); e</li>
<li>Detecção de valores discrepantes ou atípicos (<em>outliers</em>).</li>
</ul>
<p><br></p>
<p>No geral, a <strong>análise residual</strong> é útil detectar especificações incorretas do modelo e permitir a verificação das suposições do modelo.</p>
</section>
<section class="slide level2">

<h3 id="resíduos-estudentizados---i">Resíduos estudentizados - I</h3>
<p>Algumas propriedades do vetor de resíduos foram exploradas anteriormente, em particular temos que</p>
<p><span class="math display">\[\mathrm{cov}[e] = \sigma^2(I - H).\]</span> Um estimador não-viesado para <span class="math inline">\(\sigma^2\)</span> é dado por <span class="math inline">\(QM_{Res}=\frac{SQ_{Res}}{n-p}\)</span>. Por simplicidade, denotaremos <span class="math inline">\(QM_{Res}\)</span> como <span class="math inline">\(s^2\)</span>. Daí, <span class="math inline">\(\mathrm{cov}[e]\)</span> pode ser estimado por</p>
<p><span class="math display">\[\widehat{\mathrm{cov}[e]}=s^2(I - H).\]</span> Esse resultado indica que, mesmo quando a suposição de esfericidade dos erros é válida, os elementos na diagonal são diferentes, isso significa que <strong>os resíduos não são homogêneos</strong> e os elementos fora da diagonal são não-nulos, o que sugere que <strong>os resíduos não são independentes</strong>.</p>
</section>
<section class="slide level2">

<p><strong>Resíduos estudentizados internamente.</strong> As variâncias heterogêneas nos resíduos são facilmente corrigidas padronizando cada resíduo da seguinte forma</p>
<p><span class="math display">\[r_i=\frac{e_i}{s\sqrt{1-h_{ii}}}, \quad i=1,2,\ldots,n,\]</span> onde <span class="math inline">\(h_{ii}\)</span> é o <span class="math inline">\(i\)</span>-ésimo elemento diagonal da matriz <span class="math inline">\(\mathbf{H}\)</span>.</p>
<p><br><br></p>
<h4 id="algumas-considerações">Algumas considerações</h4>
<ul>
<li><p>Todos os resíduos padronizados com <span class="math inline">\(\sigma\)</span>, ao invés de <span class="math inline">\(s\)</span>, têm variância uno;</p></li>
<li><p>O comportamento probabilístico dos resíduos padronizados <span class="math inline">\(r_i\)</span> é próximo do comportamento de uma variável aleatória com distribuição <span class="math inline">\(t\)</span> de Student. Ainda, <strong>não há independência</strong> entre o numerador e o denominador de <span class="math inline">\(r_i\)</span>.</p></li>
</ul>
</section>
<section class="slide level2">

<p><span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span> sugerem padronizar cada resíduo com uma estimativa do desvio padrão omitindo a <span class="math inline">\(i\)</span>-ésima observação. Assim, o estimatidor de <span class="math inline">\(\sigma^2\)</span> para o <span class="math inline">\(i\)</span>-ésimo resíduo, é o quadrado médio residual omitindo a <span class="math inline">\(i\)</span>-ésima observação. Dessa forma, o estimador de <span class="math inline">\(\sigma^2\)</span> é dado por <span class="math inline">\(s^2_{(i)}\sqrt{1-h_{ii}}\)</span>, onde <span class="math display">\[s_{(i)}^2=\frac{1}{n-p-1}\left[(n-p)s^2-\frac{e_i^2}{1-h_{ii}}\right].\]</span></p>
<p><br></p>
<div class="fragment fade-in" data-fragment-index="2">
<p><strong>Resíduos estudentizados externamente.</strong> Os resíduos são padronizados considerando <span class="math inline">\(s_{(i)}^2\)</span>, onde <span class="math inline">\(i\)</span> indica que a <span class="math inline">\(i\)</span>-ésima observação foi omitida para o estimador de <span class="math inline">\(\sigma^2_i\)</span>. Daí, <span class="math display">\[r_i^*=\frac{e_i}{s_{(i)}\sqrt{1-h_{ii}}}.\]</span></p>
</div>
</section>
<section class="slide level2">

<h4 id="algumas-considerações-1">Algumas considerações</h4>
<ul>
<li>Sob a Suposição <strong>A5</strong>, cada resíduo estudentizado externamente segue uma distribuíção <span class="math inline">\(t_{n-p-1}\)</span>. Tal como acontece com <span class="math inline">\(e_i\)</span> e <span class="math inline">\(r_i\)</span>, os resíduos <span class="math inline">\(r_i^∗\)</span> não são independentes;</li>
</ul>
<div class="fragment fade-in" data-fragment-index="2">
<ul>
<li><span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span> mostram que tanto <span class="math inline">\(s_{(i)}\)</span> quanto os resíduos estudentizados externamente podem ser obtidos a partir dos resíduos ordinários sem repetir a regressão com a observação omitida;</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<ul>
<li>Apesar dos problemas associados ao seu uso, os resíduos observados, padronizados e estudentizados têm se mostrado úteis na prática para avaliar a qualidade do ajuste do modelo de regressão e a detecção de inadequações e outliers. Para a maioria dos casos, os três tipos de resíduos fornecem padrões muito semelhantes e levam a conclusões semelhantes.</li>
</ul>
</div>
</section>
<section class="slide level2">

<h4 id="algumas-considerações-2">Algumas considerações</h4>
<ul>
<li>As variâncias heterogêneas de <span class="math inline">\(e_i\)</span> podem <em>confundir</em> um pouco as comparações e, por essa razão, o uso de um dos resíduos estudentizados <span class="math inline">\(r_i\)</span> ou <span class="math inline">\(r_i^*\)</span> deve ser considerado;</li>
</ul>
<div class="fragment fade-in" data-fragment-index="2">
<ul>
<li>A principal vantagem do residuais estudentizados é sua conexão mais próxima com o distribuição <span class="math inline">\(t\)</span> de Student. Isso permite o uso da estatística <span class="math inline">\(t\)</span> como um critério conveniente para julgar se os resíduos são excessivamente grandes.</li>
</ul>
</div>
<p><br><br><br><br></p>
<hr>
<p><font size="6">Para detalhes, ver, e.g., <span class="citation" data-cites="searle2017">Searle e Khuri (<a href="#/referências" role="doc-biblioref" onclick="">2017</a>)</span>, <span class="citation" data-cites="rawlings:1998">Rawlings et al. (<a href="#/referências" role="doc-biblioref" onclick="">1998</a>)</span> e <span class="citation" data-cites="rao:1999">Rao e Toutenburg (<a href="#/referências" role="doc-biblioref" onclick="">1999</a>)</span>.</font></p>
</section>
<section class="slide level2">

<p><strong>Resíduos recursivos (<em>recursive residuals</em>)</strong>. Os <em>resíduos recursivos</em> são construídos de modo que eles são independentes e identicamente distribuídos quando o modelo está correto.</p>
<p><br> São calculados a partir de uma sequência de regressões começando com uma base de <span class="math inline">\(p\)</span> observações, onde <span class="math inline">\(p\)</span> é o número de parâmetros a serem estimados, e adicionando uma observação a cada etapa.</p>
<p><br> A equação de regressão calculada em cada etapa é usada para calcular o resíduo para a próxima observação a ser adicionada. Esse procedimento continua até que o último resíduo tenha sido calculado. Dessa forma, no final do procedimento haverá <span class="math inline">\(n - p\)</span> resíduos recursivos.</p>
</section>
<section class="slide level2">

<p>Suponha que uma ordem particular dos dados tenha sido adotada com o propósito de calcular os <em>resíduos recursivos</em>. Considere <span class="math inline">\(\mathbf{X}_r\)</span> a matriz com as primeiras <span class="math inline">\(r\)</span> linhas da matriz <span class="math inline">\(\mathbf{X}\)</span> e <span class="math inline">\(\widehat{\beta}_r=(\mathbf{X}_r'\mathbf{X}_r)^{-1}\mathbf{X}'_rY_r\)</span> o estimador de MQO usando as primeiras <span class="math inline">\(r\)</span> observações, onde <span class="math inline">\(Y'_r=\left[Y_1,Y_2,\ldots,Y_r\right]\)</span>, então, os <em>resíduos recursivos</em> são definidos como <span class="math display">\[w_r=\frac{Y_r-X'_r\widehat{\beta}_{r-1}}{\sqrt{1+X'_r\left(\mathbf{X}'_{r-1}\mathbf{X}_{r-1}\right)^{-1}X_r}}, \quad r=p,p+1,\ldots,n,\]</span> onde <span class="math inline">\(X_r\)</span> representa a <span class="math inline">\(r\)</span>-ésima linha de <span class="math inline">\(\mathbf{X}\)</span>.</p>
</section>
<section class="slide level2">

<h4 id="algumas-considerações-3">Algumas considerações</h4>
<ul>
<li><span class="math inline">\(w_p,w_{p+1},\ldots,w_n\)</span> são independentes e identicamente distribuidos com distribuição <span class="math inline">\(N(0,\sigma^2)\)</span>;</li>
</ul>
<p><br></p>
<ul>
<li>A geração de cada resíduo está explicitamente associada a uma observação particular e, consequentemente, <em>resíduos recursivos</em> parecem evitar algumas das “propagações” de defeitos do modelo, uma vez que são independentes e identicamente distribuídos, assim os testes exatos de normalidade e <em>outliers</em> podem ser usados;</li>
</ul>
</section>
<section class="slide level2">

<h4 id="algumas-considerações-4">Algumas considerações</h4>
<ul>
<li>Algumas desvantagens dos <em>resíduos recursivos</em>:
<ul>
<li>Alto custo computacional;</li>
<li>Nenhum resíduo está associado com as primeiras <span class="math inline">\(p-1\)</span> observações usadas como base;</li>
<li>Os resíduos não são únicos, pois depende da ordem dos dados.</li>
</ul></li>
</ul>
<p>Programas de computador apropriados podem remover o primeiro problema. Os dois últimos são parcialmente superados pelo cálculo dos <em>resíduos recursivos</em> para diferentes ordenações dos dados. Para detalhes, ver, e.g., <span class="citation" data-cites="brown:1975">Brown et al. (<a href="#/referências" role="doc-biblioref" onclick="">1975</a>)</span>.</p>
</section>
<section id="técnicas-gráficas" class="slide level2 center" data-background-color="#172a46">
<h2>Técnicas gráficas</h2>
<div class="cell">
<style type="text/css">
.center h2 {
  text-align: center !important
}
</style>
</div>
</section>
<section id="gráfico-de-resíduos-vs-valores-ajustados" class="slide level2">
<h2>Gráfico de <em>Resíduos</em> vs <em>Valores ajustados</em></h2>
<p>O gráfico dos resíduos contra os valores ajustados permite identificar alguns padrões úteis que podem ser indicativos de violação de alguma suposição do modelo.</p>
<p>Uma dispersão aleatória dos pontos acima e abaixo a linha <span class="math inline">\(\mathbb{E}[e] = 0\)</span> com quase todos os pontos de dados dentro da banda definida a <span class="math inline">\(\pm2\)</span> dois desvios padrão ( <span class="math inline">\(\pm2s\)</span> ) é esperado se as suposições forem satisfeitas.</p>
<p><br></p>
<div class="fragment fade-in" data-fragment-index="2">
<p><span style="color:#82243a"><span class="math inline">\(\hat{Y}\)</span> é usado em vez de <span class="math inline">\(Y\)</span> porque <span class="math inline">\(e\)</span> é ortogonal a <span class="math inline">\(\widehat{Y}\)</span>, mas não a <span class="math inline">\(Y\)</span>. Um gráfico de <span class="math inline">\(e\)</span> versus <span class="math inline">\(Y\)</span> mostrará um padrão devido à falta de ortogonalidade.</span></p>
</div>
<p><br></p>
<div class="fragment fade-in" data-fragment-index="3">
<p>Qualquer padrão na magnitude da dispersão em torno de zero associado com a mudança dos valores ajustados sugere <strong>variâncias heterogêneas</strong> nos resíduos.</p>
</div>
</section>
<section class="slide level2">

<h4 id="padrão-típico-de-homoscedasticidade">Padrão típico de homoscedasticidade</h4>

<img data-src="images/res1a.png" class="quarto-figure quarto-figure-center r-stretch" width="2500"></section>
<section class="slide level2">

<h4 id="padrão-típico-de-heteroscedasticidade">Padrão típico de heteroscedasticidade</h4>
<p>O formato de <em>cone</em> é o padrão típico quando a variância aumenta com a média da variável dependente.</p>

<img data-src="images/res2a.png" class="quarto-figure quarto-figure-center r-stretch" width="2500"><p>Este é o padrão esperado se a variável dependente tem uma distribuição <em>Poisson</em> ou <em>log-normal</em>, por exemplo. Dados com distribuição binomial mostrariam maior dispersão quando a probabilidade de sucessos está próxima de <span class="math inline">\(\frac12\)</span>.</p>
</section>
<section class="slide level2">

<h3 id="outros-padrões">Outros padrões</h3>
<ul>
<li><p>Qualquer assimetria da distribuição dos resíduos em torno de zero sugere um problema com o modelo ou com os pressupostos básicos;</p></li>
<li><p>Uma maioria de resíduos negativos relativamente pequenos e poucos resíduos com valores positivos grandes sugeririam uma distribuição assimétrica no lado positivo;</p></li>
<li><p>Um evidente padrão incomum nos resíduos sugere um erro sistemático nos dados ou a ausência de uma importante covariável no modelo;</p></li>
<li><p>Um dado atípico residual apareceria em qualquer um dos gráficos dos resíduos como um ponto bem fora da banda que contém a maioria dos resíduos. No entanto, um outlier em <span class="math inline">\(Y\)</span> não terá necessariamente um dado atípico residual.</p></li>
</ul>
</section>
<section class="slide level2">

<h3 id="outros-padrões-1">Outros padrões</h3>
<p>O formato de <em>parábola</em> é o padrão típico quando os dados sugerem um termo quadrático nas covariáveis.</p>

<img data-src="images/res3a.png" class="quarto-figure quarto-figure-center r-stretch" width="2500"></section>
<section class="slide level2">

<h3 id="outros-padrões-2">Outros padrões</h3>

<img data-src="images/resid_plots.gif" class="quarto-figure quarto-figure-center r-stretch" width="2500"></section>
<section class="slide level2">

<h3 id="gráfico-de-resíduos-vs-covariáveis">Gráfico de <em>Resíduos</em> vs <em>Covariáveis</em></h3>
<p>Os gráficos dos resíduos contra as covariáveis têm interpretações semelhantes aos gráficos contra <span class="math inline">\(\hat{Y}\)</span>.</p>
<p><br></p>
<ul>
<li>Alguns padrões nos gráficos como por exemplo a diferenças na magnitude da dispersão cerca de zero que sugere variações heterogêneas ou a ausência de um termo polinomial de alto grau nas covariáveis resulta evidente nesse tipo de gráficos;</li>
</ul>
<blockquote>
<p>No entanto, inadequações no modelo associadas a uma covariável, como um termo polinomial de alto grau ausente, podem ser “<em>camufladas</em>” pelos efeitos e distribuição de outras covariáveis.</p>
</blockquote>
</section>
<section class="slide level2">

<ul>
<li><p>Pontos de <em>alavancagem</em> e dados atípicos (<em>outliers</em>) podem ser revelados nos gráficos. Observações que aparecem isoladas ou pontos nos extremos da escala <span class="math inline">\(X_i\)</span> são potencialmente <em>influentes</em> por causa de seus valores extremos para essa covariável em particular.</p></li>
<li><p>De acordo com as suposições do modelo de regressão, os resíduos são não-correlacionados com cada uma das covariáveis, isso significa que não deve existir um padrão definido no gráfico. O mesmo deve ser caracterizado por uma dispersão aleatória de pontos.</p></li>
</ul>
<blockquote>
<p>Qualquer padrão discernível neste gráfico pode indicar violação de algumas suposições.</p>
</blockquote>
</section>
<section class="slide level2">

<h4 id="padrão-de-não-linearidade">Padrão de não-linearidade</h4>
<p>Se a suposição de linearidade não é satisfeita, pode-se observar o padrão a seguir. Neste caso uma <em>transformação</em> no vetor <span class="math inline">\(Y\)</span> e/ou nas covariáveis pode ser necessária para atingir a <ins>linearidade</ins>.</p>

<img data-src="images/res4a.png" class="quarto-figure quarto-figure-center r-stretch" width="2500"></section>
<section class="slide level2">

<h4 id="padrão-de-não-esfericidade">Padrão de não-esfericidade</h4>
<p>Um gráfico com esse padrão pode indicar a presença de <em>heterogeneidade</em> na variância. Neste caso, uma <em>transformação</em> dos dados pode ser útil para “<em>estabilizar</em>” a variância.</p>

<img data-src="images/res5a.png" class="quarto-figure quarto-figure-center r-stretch" width="800"></section>
<section class="slide level2">

<h3 id="gráfico-de-resíduos-vs-tempo">Gráfico de <em>Resíduos</em> vs <em>tempo</em></h3>
<p>Esse tipo de gráfico pode ser útil para sugerir a violação da suposição de independência dos erros. Os resíduos indexados no tempo podem evidenciar correlação serial, ou seja, o resíduo em um ponto no tempo apresenta um grau de dependência com os resíduos anteriores.</p>
<blockquote>
<p>Dados clássicos de séries temporais, como os dados gerados pelo monitoramento contínuo de algum processo, são prontamente reconhecidos como tais e espera-se que tenham resíduos correlacionados. Modelos e análises de séries temporais levam em consideração essas correlações seriais e devem ser usados em tais casos.</p>
</blockquote>
<p><br><br></p>
<hr>
<p>Para detalhes, ver, e.g., <span class="citation" data-cites="fuller:1996">Fuller (<a href="#/referências" role="doc-biblioref" onclick="">1996</a>)</span>, <span class="citation" data-cites="brockwell:davis:2002">Brockwell e Davis (<a href="#/referências" role="doc-biblioref" onclick="">2002</a>)</span>.</p>
</section>
<section class="slide level2">

<h3 id="gráfico-de-resíduos-vs-tempo-1">Gráfico de <em>Resíduos</em> vs <em>tempo</em></h3>

<img data-src="images/res6.png" class="quarto-figure quarto-figure-center r-stretch" width="900"></section>
<section id="pontos-influentes-e-de-alavancagem" class="slide level2 center" data-background-color="#172a46">
<h2>Pontos influentes e de alavancagem</h2>
</section>
<section id="pontos-influentes" class="slide level2">
<h2>Pontos influentes</h2>
<p>Uma observação é dita <strong>influente</strong> quanto a sua eliminação da amostra altera de forma significativa o modelo ajustado, i.e., a sua eliminação altera as estimativas para os parâmetros e, consequentemente, os resíduos, as previsões, etc.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/influente1.png" width="550"></p>
<figcaption>Não influente</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/influente2.png" width="550"></p>
<figcaption>Influente</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>Quando nosso modelo envolve muitas covariáveis, não é possível detectar tal situação graficamente. No entanto, gostaríamos de saber da existência de tais pontos na amostra. Observe que, na maioria dos cenários, olhar para os resíduos pode não ser de utilidade, pois o residual para este tipo de pontos é <strong>zero</strong>!</p>
<p><br></p>
<blockquote>
<p>O ponto não é um dado atípico porque não tem um resíduo muito grande, mas é um ponto muito <em>influente</em>. A ideia geral é identificar esse tipo de pontos e, após uma análise rigorosa, decidir se dito ponto pode ou não ser excluído da amostra.</p>
</blockquote>
<p><br><br><br><br></p>
<hr>
<p><font size="6">Para detalhes, veja, e.g., <span class="citation" data-cites="cook:weisberg:1982">Cook e Weisberg (<a href="#/referências" role="doc-biblioref" onclick="">1982</a>)</span>.</font></p>
</section>
<section class="slide level2">

<p>Algumas medidas de influência para detectar esse tipo de pontos. Cada uma delas mede o efeito de deletar a <span class="math inline">\(i\)</span>-ésima observação:</p>
<ul>
<li><strong>Distâncias de Cook</strong> ( <span class="math inline">\(D_i\)</span> ): Mede o efeito no vetor <span class="math inline">\(\widehat{\beta}\)</span>;</li>
<li><strong>DFFITS</strong> ( <span class="math inline">\(\mathrm{DFFITS}_i\)</span> ): Mede o efeito em <span class="math inline">\(\hat{Y}_i\)</span>;</li>
<li><strong>DFBETAS</strong> ( <span class="math inline">\(\mathrm{DFBETAS}_{j(i)}\)</span> ): Mede o efeito em <span class="math inline">\(\widehat{\beta}_i\)</span>;</li>
<li><strong>COVRATIO</strong> ( <span class="math inline">\(\mathrm{COVRATIO}_i\)</span> ): Mede o efeito sobre a matriz de covariâncias das estimativas dos parâmetros.</li>
</ul>
<p>Os três primeiros, a distância de Cook, <span class="math inline">\(\mathrm{DFFITS}\)</span> e <span class="math inline">\(\mathrm{DFBETAS}\)</span>, podem ser considerados casos especiais de uma abordagem geral para medir o impacto da exclusão a <span class="math inline">\(i\)</span>-ésima observação em qualquer conjunto de <span class="math inline">\(k\)</span> funções linearmente independentes de <span class="math inline">\(\beta\)</span>.</p>
</section>
<section id="análise-de-sensibilidade" class="slide level2 center" data-background-color="#172a46">
<h2>Análise de sensibilidade</h2>
</section>
<section id="consequências-da-omissão-de-uma-observação" class="slide level2">
<h2>Consequências da omissão de uma observação</h2>
<p>Considere o Teorema A.18 na p.&nbsp;358 em <span class="citation" data-cites="rao:1999">Rao e Toutenburg (<a href="#/referências" role="doc-biblioref" onclick="">1999</a>)</span>.</p>
<p><br></p>
<p><strong>Teorema A.18</strong>. Sejam <span class="math inline">\(A_{p\times p}, B_{p\times n}, C_{n\times n}\)</span> e <span class="math inline">\(D_{n\times p}\)</span> matrizes. Suponha que a inversa de <span class="math inline">\(A\)</span> e <span class="math inline">\(C\)</span> existem. Então:</p>
<ol type="1">
<li><span class="math inline">\(\left(A+BCD\right)^{-1}=A^{-1}-A^{-1}B(C^{-1}+DA^{-1}B)^{-1}DA^{-1}\)</span>;<br><br></li>
<li>Se <span class="math inline">\(1+b'A^{-1}a\ne0\)</span>, então <span class="math display">\[\left(A+ab'\right)^{-1}=A^{-1}-\frac{A^{-1}ab'A^{-1}}{1+b'A^{-1}a}.\]</span></li>
</ol>
</section>
<section class="slide level2">

<p><strong>Notação</strong>: Sejam <span class="math inline">\(Y_{(i)}\)</span> e <span class="math inline">\(\mathbf{X}_{(i)}\)</span>, respectivamente, o vetor de observações e a matriz de covariáveis quando a <span class="math inline">\(i\)</span>-ésima observação é omitida, i.e., a <span class="math inline">\(i\)</span>-ésima linha de <span class="math inline">\(Y\)</span> e <span class="math inline">\(\mathbf{X}\)</span> são omitidas. Dessa forma, <span class="math display">\[\mathbf{X}'\mathbf{X}=\sum_{j=1}^n\mathbf{x}_j\mathbf{x}_j'=\mathbf{X}_{(i)}'\mathbf{X}_{(i)}+\mathbf{x}_i\mathbf{x}_i',\]</span> onde <span class="math inline">\(\mathbf{x}_i\)</span> representa a <span class="math inline">\(i\)</span>-ésima linha de <span class="math inline">\(\mathbf{X}\)</span>, i.e., <span class="math inline">\(\mathbf{x}_i\)</span> é um vetor linha.</p>
<p><br></p>
<p>Suponha que o <span class="math inline">\(\mathrm{posto}(\mathbf{X}_{(i)})=p-1\)</span>, então a inversa de <span class="math inline">\(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\)</span> é dada por</p>
<div class="math">
<p><span class="math display">\[
\begin{aligned}
\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}&amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i}.
\end{aligned}
\]</span></p>
</div>
</section>
<section class="slide level2">

<p>Daí,</p>
<div class="math">
<p><span class="math display">\[
\begin{aligned}
\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}&amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i}\\
&amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}},
\end{aligned}
\]</span></p>
</div>
<p>onde <span class="math inline">\(h_{ii}=\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\)</span> representa o <span class="math inline">\(i\)</span>-ésimo elemento diagonal da matriz <span class="math inline">\(\mathbf{H}\)</span>.</p>
<p>O estimador do vetor de parâmetros, após a exclusão da <span class="math inline">\(i\)</span>-ésima observação, é dado por</p>
<p><span class="math display">\[\widehat{\beta}_{(i)}=\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\mathbf{X}_{(i)}'Y_{(i)}.\]</span></p>
</section>
<section class="slide level2">

<p>Portanto, o <span class="math inline">\(i\)</span>-ésimo residual é dado por</p>
<div class="math">
<p><span class="math display">\[
  \begin{aligned}
    e_{i(i)}&amp;=Y_i-\mathbf{x}_i'\widehat{\beta}_{(i)}=Y_i-\mathbf{x}_i'\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\mathbf{X}_{(i)}'Y_{(i)}=Y_i-\mathbf{x}_i'\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\left(\mathbf{X}'Y-\mathbf{x}_iY_i\right)\\
    &amp;=Y_i-\mathbf{x}_i'\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\right]\left(\mathbf{X}'Y-\mathbf{x}_iY_i\right)\\
    &amp;=Y_i-\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\frac{\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\mathbf{X}'Y+\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_iY_i\\
    &amp;\hspace{17cm}+\frac{\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i}{1-h_{ii}}Y_i\\
    &amp;=Y_i-\widehat{Y}_i-\frac{h_{ii}\widehat{Y}_i}{1-h_{ii}}+h_{ii}Y_i+\frac{h_{ii}^2Y_i}{1-h_{ii}}
    =\frac{Y_i-\widehat{Y}_i}{1-h_{ii}}\\
   e_{i(i)} &amp;=\frac{e_i}{1-h_{ii}} \quad\blacksquare
  \end{aligned}
\]</span></p>
</div>
</section>
<section class="slide level2">

<p>Comparando os estimadores de MQO para ambos cenários, temos que</p>
<div class="math">
<p><span class="math display">\[
  \begin{aligned}
    \widehat{\beta}-\widehat{\beta}_{(i)}&amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\mathbf{X}_{(i)}'Y_{(i)}\\
    &amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\left[\mathbf{X}'Y-\mathbf{x}_iY_i\right]\\
    &amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\mathbf{X}'Y+\left(\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right)^{-1}\mathbf{x}_iY_i\\
    &amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\right]\mathbf{X}'Y\\
    &amp;\hspace{13cm}+\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\right]\mathbf{x}_iY_i
  \end{aligned}
\]</span></p>
</div>
</section>
<section class="slide level2">

<div class="math">
<p><span class="math display">\[
  \begin{aligned}
    \widehat{\beta}-\widehat{\beta}_{(i)}&amp;=
    \left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y-\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\right]\mathbf{X}'Y\\
    &amp;\hspace{13cm}+\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}+\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}}{1-h_{ii}}\right]\mathbf{x}_iY_i\\
    &amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\left[Y_i+\frac{\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_iY_i}{1-h_{ii}}-\frac{\mathbf{x}_i'\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y}{1-h_{ii}}\right]\\
    &amp;=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_i\left[Y_i+\frac{h_{ii}Y_i}{1-h_{ii}}-\frac{\hat{Y}_i}{1-h_{ii}}\right]\\
    &amp;=\frac{\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{x}_ie_{i}}{1-h_{ii}} \quad\blacksquare
  \end{aligned}
\]</span></p>
</div>
</section>
<section id="medidas-de-influência" class="slide level2 center" data-background-color="#172a46">
<h2>Medidas de influência</h2>
</section>
<section id="distância-de-cook" class="slide level2">
<h2>Distância de Cook</h2>
<p>Considerando as Suposições <strong>A1-A5</strong>, temos que <span class="math inline">\(\widehat{\beta}\)</span> segue uma distribuição normal <span class="math inline">\(p\)</span>-variada com vetor de médias <span class="math inline">\(\beta\)</span> e matriz de covariâncias <span class="math inline">\(\sigma^2\left(\mathbf{X}'\mathbf{X}\right)^{-1}\)</span>. Sabemos que a forma quadrática <span class="math display">\[\frac{\left(\beta-\widehat{\beta}\right)'\left(\mathbf{X}'\mathbf{X}\right)\left(\beta-\widehat{\beta}\right)}{p\,s^2}\]</span> segue uma distribuição <span class="math inline">\(F_{p,n-p}\)</span>. Dessa forma, <span class="math display">\[\frac{\left(\beta-\widehat{\beta}\right)'\left(\mathbf{X}'\mathbf{X}\right)\left(\beta-\widehat{\beta}\right)}{p\,s^2}\le F_{p,n-p,\alpha}\]</span> define um elipsoide confiança de <span class="math inline">\(100(1-\alpha)\%\)</span> para o vetor <span class="math inline">\(\beta\)</span>.</p>
</section>
<section class="slide level2">

<p><span class="citation" data-cites="cook:1977">Cook (<a href="#/referências" role="doc-biblioref" onclick="">1977</a>)</span> propõe a seguinte estatística para detectar dados influentes</p>
<div class="math">
<p><span class="math display">\[
\begin{aligned}
D_i&amp;=\frac{\left(\widehat{\beta}_{(i)}-\widehat{\beta}\right)'\left(\mathbf{X}'\mathbf{X}\right)\left(\widehat{\beta}_{(i)}-\widehat{\beta}\right)}{p\,s^2}=\frac{\left(\hat{Y}_{(i)}-\hat{Y}\right)'\left(\hat{Y}_{(i)}-\hat{Y}\right)}{p\,s^2}\\
&amp;=\frac{e_{i}^2h_{ii}}{p\, s^2(1-h_{ii})^2}=\frac{h_{ii}}{1-h_{ii}}\frac{r_i^2}{p},
\end{aligned}\]</span></p>
</div>
<p>onde <span class="math inline">\(r_i\)</span> são os resíduos estudentizado internamente.</p>
</section>
<section class="slide level2">

<h3 id="algumas-considerações-5">Algumas considerações</h3>
<ul>
<li>Grandes valores de <span class="math inline">\(D_i\)</span> indicam a presença de observações influentes. Dessa forma, a estatística <span class="math inline">\(D_i\)</span> mede a mudança em <span class="math inline">\(\widehat{\beta}\)</span> quando uma observação em particular é omitida;</li>
</ul>
<p><br></p>
<div class="fragment fade-in" data-fragment-index="2">
<ul>
<li><span class="math inline">\(D_i\)</span> depende de <span class="math inline">\(h_{ii}\)</span>, daí <span class="math inline">\(D_i\)</span> se torna grande se <span class="math inline">\(h_{ii}\)</span> e/ou <span class="math inline">\(r_i^2\)</span> são grandes;</li>
</ul>
</div>
<p><br></p>
<div class="fragment fade-in" data-fragment-index="3">
<ul>
<li>Pela analogia com o elipsoide confiança, <span class="citation" data-cites="cook:1977">Cook (<a href="#/referências" role="doc-biblioref" onclick="">1977</a>)</span> sugere comparar <span class="math inline">\(D_i\)</span> com percentis da distribuição <span class="math inline">\(F_{p,n-p}\)</span>. Assim, quanto maior o percentil correspondente a <span class="math inline">\(D_i\)</span>, mais influente é a <span class="math inline">\(i\)</span>-ésima observação.</li>
</ul>
</div>
</section>
<section class="slide level2">

<h3 id="dffits">DFFITS</h3>
<p>Proposto por <span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span>, a estatística mede a mudança em <span class="math inline">\(\hat{Y}_i\)</span> quando a <span class="math inline">\(i\)</span>-ésima observação é omitida. A estatística é dada por</p>
<p><span class="math display">\[\mathrm{DFFITS}_i=\frac{\hat{Y}_i-\hat{Y}_{i(i)}}{s_{(i)}\sqrt{h_{ii}}}=\left(\frac{h_{ii}}{1-h_{ii}}\right)\frac{e_i}{s_{(i)}\sqrt{1-h_{ii}}},\]</span> onde <span class="math inline">\(\hat{Y}_{i(i)}\)</span> é o <span class="math inline">\(i\)</span>-ésimo elemento do vetor <span class="math inline">\(\hat{Y}\)</span>, quando a <span class="math inline">\(i\)</span>-ésima observação é omitida ao estimar <span class="math inline">\(\beta\)</span> e <span class="math inline">\(s_{(i)}^2=\frac{1}{n-p-1}\left[(n-p)s^2-\frac{e_i^2}{1-h_{ii}}\right]\)</span>.</p>
</section>
<section class="slide level2">

<h3 id="dffits-1">DFFITS</h3>
<ul>
<li><p><span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span> sugerem que o valor absoluto dos valores da estatística <span class="math inline">\(\mathrm{DFFITS}\)</span> maiores do que <span class="math inline">\(2\sqrt{\frac{p}{n}}\)</span> sugerem a presença de observações influentes;</p></li>
<li><p>A sua relação com a distância de Cook é dada pela seguinte expressão <span class="math display">\[D_i=(\mathrm{DFFITS}_i)^2\left(\frac{s_{(i)}^2}{p\, s^2}\right).\]</span></p></li>
</ul>
</section>
<section class="slide level2">

<h3 id="dfbetas">DFBETAS</h3>
<p>A distância de Cook revela o impacto da <span class="math inline">\(i\)</span>-ésima observação no vetor <span class="math inline">\(\beta\)</span>.</p>
<p>As mudanças para o coeficientes marginais são identificadas com os <span class="math inline">\(\textrm{DFBETAS}_{j(i)}, \, j=0,1,2,\ldots,p-1\)</span>. Cada <span class="math inline">\(\textrm{DFBETAS}_{j(i)}\)</span> representa a mudança padronizada em <span class="math inline">\(\widehat{\beta}_j\)</span> quando a <span class="math inline">\(i\)</span>-ésima observação é omitida da análise. A estatística é dada por <span class="math display">\[\mathrm{DFBETAS}_{j(i)}=\frac{\widehat{\beta}_j-\widehat{\beta}_{j(i)}}{s_i\sqrt{c_{jj}}},\]</span> onde <span class="math inline">\(c_{jj}\)</span> é o <span class="math inline">\((j+1)\)</span>-ésimo elemento diagonal da matriz <span class="math inline">\(\left(\mathbf{X}'\mathbf{X}\right)^{-1}\)</span>.</p>
</section>
<section class="slide level2">

<h3 id="dfbetas-1">DFBETAS</h3>
<ul>
<li>Embora o formato pareça o de uma estatística <span class="math inline">\(t\)</span>-student, a mesma não pode ser usada para avaliar significância;</li>
<li>Valores de <span class="math inline">\(\textrm{DFBETAS}_{j(i)}\)</span> maiores que <span class="math inline">\(2\)</span> devem indicar um maior, mas improvável, impacto de um único ponto. O ponto <span class="math inline">\(\frac{2}{\sqrt{n}}\)</span> tenderá a destacar a mesma proporção de pontos de influência nos dados. Para detalhes, veja <span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span>.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="covratio">COVRATIO</h3>
<p>O impacto da <span class="math inline">\(i\)</span>-ésima observação na matriz de covariâncias do vetor <span class="math inline">\(\beta\)</span> é medido pela razão dos determinantes das duas matrizes de covariâncias, i.e.,</p>
<p><span class="math display">\[\mathrm{COVRATIO}=\frac{\det\left(s_{(i)}^2\left[\mathbf{X}_{(i)}'\mathbf{X}_{(i)}\right]^{-1}\right)}{\det\left(s^2\left[\mathbf{X}'\mathbf{X}\right]^{-1}\right)}=\left[\left(\frac{n-p-1}{n-p}+\frac{\left(r_i^*\right)^2}{n-p}\right)^{p-1}(1-h_{ii})\right]^{-1}.\]</span></p>
</section>
<section class="slide level2">

<h3 id="covratio-1">COVRATIO</h3>
<ul>
<li><p>Valores pŕoximos de <span class="math inline">\(1\)</span> indicam que a <span class="math inline">\(i\)</span>-ésima observação tem um pequeno efeito na precisão das estimativas;</p></li>
<li><p>Um COVRATIO maior que <span class="math inline">\(1\)</span> indica que a presença da <span class="math inline">\(i\)</span>-ésima observação aumenta a precisão das estimativas; uma proporção menor que <span class="math inline">\(1\)</span> indica que a presença da observação prejudica a precisão de as estimativas;</p></li>
<li><p><span class="citation" data-cites="belsley:2005">Belsley et al. (<a href="#/referências" role="doc-biblioref" onclick="">2005</a>)</span> sugerem que observações com valores do <span class="math inline">\(\mathrm{COVRATIO}\)</span> fora dos limites <span class="math inline">\(1\pm3\frac{p}{n}\)</span> podem ser consideradas como influentes.</p></li>
</ul>
<blockquote>
<p>As estatísticas de influência devem ser usadas como ferramentas de diagnóstico para identificar as observações com maior impacto nos resultados da regressão. Embora algumas das medidas de influência se assemelhem às estatísticas de teste, elas não devem ser interpretadas como testes de significância para observações influentes.</p>
</blockquote>
</section>
<section id="referências" class="slide level2 smaller scrollable">
<h2>Referências</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-belsley:2005" class="csl-entry" role="listitem">
Belsley, D. A., Kuh, E., e Welsch, R. E. (2005), <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>, Wiley Series em Probability e Statistics, Wiley.
</div>
<div id="ref-brockwell:davis:2002" class="csl-entry" role="listitem">
Brockwell, P., e Davis, R. (2002), <em>Introduction to Time Series and Forecasting</em>, Springer Verlag.
</div>
<div id="ref-brown:1975" class="csl-entry" role="listitem">
Brown, R. L., Durbin, J., e Evans, J. M. (1975), <span>“Techniques for Testing the Constancy of Regression Relationships over Time”</span>, <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 37, 149–192.
</div>
<div id="ref-cook:1977" class="csl-entry" role="listitem">
Cook, R. D. (1977), <span>“Detection of influential observation in linear regression”</span>, <em>Technometrics</em>, 19, 15–18.
</div>
<div id="ref-cook:weisberg:1982" class="csl-entry" role="listitem">
Cook, R. D., e Weisberg, S. (1982), <em>Residual and influence in regression</em>, New York: Chapman; Hall.
</div>
<div id="ref-fuller:1996" class="csl-entry" role="listitem">
Fuller, W. A. (1996), <em>Introduction to statistical time series</em>, John Wiley &amp; Sons.
</div>
<div id="ref-rao:1999" class="csl-entry" role="listitem">
Rao, C. R., e Toutenburg, H. (1999), <em>Linear Models: Least Squares and Alternatives</em>, Springer Series em Statistics, Springer New York.
</div>
<div id="ref-rawlings:1998" class="csl-entry" role="listitem">
Rawlings, J. O., Pantula, S. G., e Dickey, D. A. (1998), <em>Applied regression analysis: a research tool</em>, Springer texts em statistics, New York, NY.: Springer.
</div>
<div id="ref-searle2017" class="csl-entry" role="listitem">
Searle, S., e Khuri, A. (2017), <em>Matrix Algebra Useful for Statistics</em>, Wiley.
</div>
</div>
</section>
<section id="política-de-proteção-aos-direitos-autorais" class="slide level2">
<h2>Política de proteção aos direitos autorais</h2>
<blockquote>
<p><span style="color:grey"><font size="6">O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser o detentor dos direitos sobre o conteúdo disponível na plataforma, o <strong>LECON</strong> e o <strong>NEAEST</strong> detém direito exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5<sup>o</sup>, inciso XXVII, da Constituição Federal e os Artigos 7<sup>o</sup> e 28<sup>o</sup>, da Lei 9.610/98. A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do <strong>LECON</strong> e o <strong>NEAEST</strong>, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo caracterizar conduta criminosa, conforme Artigo 184<sup>o</sup>, §1<sup>o</sup> a 3<sup>o</sup>, do Código Penal. É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer conteúdo disponível na plataforma.</font></span></p>
</blockquote>

<img data-src="images/logo_neaest_lecon.png" class="quarto-figure quarto-figure-center r-stretch" width="1800"><p><span style="color:grey"><font size="4">Material elaborado pela equipe LECON/NEAEST: Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi e Nátaly A. Jiménez.</font></span></p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/logo_neaest.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="aula9_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="aula9_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="aula9_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="aula9_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiada");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiada");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>